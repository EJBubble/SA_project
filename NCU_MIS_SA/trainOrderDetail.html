<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Jekyll v3.8.5">

  <title>訂票詳情</title>

  <!-- Bootstrap core CSS -->
  <link href="statics/css/bootstrap.min.css" rel="stylesheet">
  <link href="statics/css/font-awesome.min.css" rel="stylesheet">
  <link href="statics/icon/favicon.ico" type="image/x-icon" rel="icon">
  <link href="statics/icon/favicon.ico" type="image/x-icon" rel="shortcut icon">
  <!-- Google Fonts(from login) -->
  <link href="https://fonts.gstatic.com" rel="preconnect" />
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet"
  />

  <!-- Vendor CSS Files(from login) -->
  <link
    href="assetsA/vendor/bootstrap/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    href="assetsA/vendor/bootstrap-icons/bootstrap-icons.css"
    rel="stylesheet"
  />
  <link
    href="assetsA/vendor/boxicons/css/boxicons.min.css"
    rel="stylesheet"
  />
  <link href="assetsA/vendor/quill/quill.snow.css" rel="stylesheet" />
  <link href="assetsA/vendor/quill/quill.bubble.css" rel="stylesheet" />
  <link href="assetsA/vendor/remixicon/remixicon.css" rel="stylesheet" />
  <link href="assetsA/vendor/simple-datatables/style.css" rel="stylesheet" />

  <!-- Template Main CSS File(from login) -->
  <link href="assetsA/css/style.css" rel="stylesheet" />
  <link href="assets/css/styleA.css" rel="stylesheet">


  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <!-- Custom styles for this template -->
  <link href="statics/css/product.css" rel="stylesheet">
  <link href="statics/css/jquery-confirm.css" rel="stylesheet">

  <script src="statics/js/jquery-3.4.1.min.js"></script>
  <script src="statics/js/jquery-confirm.js"></script>
  <script src="statics/js/big.min.js"></script>
  <script src="statics/js/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
</head>

<body>
 <!-- ======= Header ======= -->
 <header id="header" class="fixed-top">
  <div class="container d-flex align-items-center">

    <h1 class="logo me-auto"><a href="indexA.html"><span>EZ</span>訂火車</a></h1>
    <!-- Uncomment below if you prefer to use an image logo -->
    <!-- <a href="index.html" class="logo me-auto me-lg-0"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

    <nav id="navbar" class="navbar order-last order-lg-0">
      <ul>
        <li><a href="indexA.html" class="active" id="link0">Home</a></li>

        <li><a href="railway.html" id="link1">關於台鐵</a></li>
        <li><a href="travel.html" id="link2">旅遊票券</a></li>
        <li><a href="railwaypolice.html" id="link3">鐵路警察局</a></li>
        <li><a href="contact.html" id="link4">聯絡客服</a></li>
        <li><a href="train.html" id="link5">列車查詢</a></li>
        <li><a href="booking.html" id="link6">訂票</a></li>
        <li><a href="pagesLogin.html" id="link7">登入</a></li>
        <li><a href="pagesRegister.html" id="link8">註冊</a></li>
        <li><a href="trainOrderDetail.html" id="link9"></a></li>

      </ul>
      <i class="bi bi-list mobile-nav-toggle"></i>
    </nav><!-- .navbar -->

    <div class="header-social-links d-flex">
      <a href="#" class="twitter"><i class="bu bi-twitter"></i></a>
      <a href="#" class="facebook"><i class="bu bi-facebook"></i></a>
      <a href="#" class="instagram"><i class="bu bi-instagram"></i></a>
      <a href="#" class="linkedin"><i class="bu bi-linkedin"></i></i></a>
    </div>

  </div>
</header><!-- End Header -->
  <br>
  <br>
  <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center bg-light">
    <h1 class="display-4">訂票詳情</h1>
    <p class="lead">以下為該筆訂票之所有資料</p>
  </div>

  <div class="container">
	  <div class="py-5">    
	  	<!-- <div class="my-3 p-3 bg-white rounded box-shadow">
        <h6 class="border-bottom border-gray pb-2 mb-0">訂票資料</h6>
        
        <div class="row">
	        <div class="col media text-muted pt-3">
	          <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
	            <strong class="d-block text-gray-dark">訂票編號</strong>
	            <span id="order_id">{{order_id}}</span>
	          </p>
	        </div>
	        
	        <div class="col media text-muted pt-3">
             <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
               <strong class="d-block text-gray-dark">修改日期</strong>
               <span id="modify">{{modify}}</span>
             </p>
           </div>
           
           <div class="col media text-muted pt-3">
             <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
               <strong class="d-block text-gray-dark">建立日期</strong>
               <span id="create">{{create}}</span>
             </p>
           </div>
         </div>
         
         <div class="row">
           <div class="col media text-muted pt-3">
             <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
               <strong class="d-block text-gray-dark">姓名</strong>
               <span id="last_name" class="p-2">{{last_name}}</span><span id="first_name">{{first_name}}</span>
             </p>
           </div>
           
          <div class="col media text-muted pt-3">
            <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
              <strong class="d-block text-gray-dark">手機號碼</strong>
              <span id="phone">{{phone}}</span>
            </p>
          </div>
          
          <div class="col media text-muted pt-3">
            <p class="media-body pb-3 mb-0 lh-125 border-bottom border-gray">
              <strong class="d-block text-gray-dark">電子郵件</strong>
              <span id="email">{{email}}</span>
            </p>
          </div>
         </div>
         
         <div class="row">
                    
         </div>
        
        <H3 class="d-block text-right mt-3">總價：$ <span id="total">{{total}}</span></H3>
      </div> -->

       
       <div class="table-responsive">
         <table id="table" class="table table-striped table-sm">
           <thead>
             <tr>
               <th class="text-center" style="width: 10%">訂票編號</th>
               <th class="text-center" style="width: 40%">車票詳細</th>
               <th class="text-center" style="width: 15%">單價</th>
               <th class="text-center" style="width: 10%">數量</th>
               <th class="text-center" style="width: 15%">小計</th>
             </tr>
           </thead>
           <tbody id="panel">
           </tbody>
         </table>
       </div>
     </div>
  </div>

  <script type="text/javascript">
    // 取得網址參數
    var url_string = window.location.href;
    var url = new URL(url_string);
    var id = url.searchParams.get("id");
    var sql_num = 0;

    // console.log("helllo");
    let memberId = new URL(location.href).searchParams.get("id");
    console.log("memberId", memberId);
    if(memberId){
      console.log("123")
     
      document.getElementById("link1").href += `?id=${memberId}` 
      document.getElementById("link2").href += `?id=${memberId}` 
      document.getElementById("link3").href += `?id=${memberId}` 
      document.getElementById("link4").href += `?id=${memberId}` 
      document.getElementById("link5").href += `?id=${memberId}` 
      document.getElementById("link6").href += `?id=${memberId}` 
      document.getElementById("link8").href = `memberProfile.html?id=${memberId}`
      document.getElementById("link7").innerHTML = "登出" 
      document.getElementById("link8").innerHTML = "會員修改"
      document.getElementById("link9").innerHTML += `我的車票` 
      document.getElementById("link9").href += `?id=${memberId}` 
    }

    // function detele(id) {
    //     var name = $('#member_name').val();
    //     var email = $('#member_email').val();
    //     var password = $('#member_password').val();

    //     var password_rule = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;

    //     if(!password_rule.test(password)) {
    //         alert("密碼格式不符，長度至少8，且至少包含一個數字和英文字母！");
    //     }
    //     else {
    //         // 將資料組成JSON格式
    //         var data_object = {
    //             "id": id,
    //             "name": name,
    //             "email": email,
    //             "password": password
    //         };

    //         // 將JSON格式轉換成字串
    //         var data_string = JSON.stringify(data_object);

    //         // 發出POST的PUT請求
    //         $.ajax({
    //                 type: "PUT",
    //                 url: "api/member.do",
    //                 data: data_string,
    //                 crossDomain: true,
    //                 cache: false,
    //                 dataType: 'json',
    //                 timeout: 5000,
    //                 success: function (response) {
    //                     $('#flashMessage').html(response.message);
    //                     $('#flashMessage').show();
    //                     if(response.status == 200){
    //                         updateSQLTable(response.response);
    //                         getMember();
    //                     }
    //                 },
    //                 error: function () {
    //                     alert("無法連線到伺服器！");
    //                 }
    //         });
    //     }
    // }

    // // 更新SQL指令歷史表格
    // function updateSQLTable(data) {
    //     var time = (data.time / 1000000).toFixed(2);
    //     var table_html = "";
        
    //     sql_num += 1

    //     table_html += '<tr>';
    //     table_html += '<td>' + sql_num + '</td>';
    //     table_html += '<td>' + data.sql + '</td>';
    //     table_html += '<td style="text-align: right">' + '0' + '</td>';
    //     table_html += '<td style="text-align: right">' + data.row + '</td>';
    //     table_html += '<td style="text-align: right">' + data.row + '</td>';
    //     table_html += '<td style="text-align: right">' + time + '</td>';
    //     table_html += '</tr>';
    //     $("#sql_log > tbody").append(table_html);
    //     $("#sql_summary").html("(default) " + data.row + " queries took " + time + " ms");
    // }

    function getTicket() {
        $.ajax({
            type: "GET",
            url: "api/book.do",
            crossDomain: true,
            data: "id=" + id,
            cache: false,
            dataType: 'json',
            timeout: 5000,
            success: function (response) {
                if(response.status == 200){
                  //updateSQLTable(response.response);
                  updateTable(response.response.data);
                }
                console.log(response);
            },
            error: function () {
                alert("無法連線到伺服器！");
            }
        });
    }

    function updateTable(data) {
        $("#table > tbody").empty();
        var table_html = '';
        $.each(data, function(index, value) {
            table_html += '<tr><td scope="row">' + value['id'] + '</td>';
            table_html += `<td>${value['train_type']} ${value['trainNO']} </br>日期: ${value['train_date']}</br> ${value['departureStation']} → ${value['arrivalStation']}</br>出發時間: ${value['departureTime']} → 抵達時間: ${value['arrivalTime']}</td>`;
            table_html += '<td>' + value['ticket_price']/value['ticket_amount'] + '</td>';
            table_html += '<td>' + value['ticket_amount'] + '</td>';
            table_html += '<td>' + value['ticket_price'] + '</td>';
            // table_html += '<td>' + '<a href="edit.html?id=' + value['id'] + '">編輯</a> | ';
            // table_html += '<a href="javascript: deleteMember(' + value['id'] + ');">刪除</a></td></tr>';
        })

        $("#table > tbody").append(table_html);
    }

    // $('#submit').click(function() {
    //     updateMember(id)
    // });
    
    $(document).ready(function() {
      // 發出GET的AJAX請求取得原本該會員的資料
       $("#sql_log > tbody").empty();
        getTicket();
    });
</script>


  <script>

  </script>
</body>

</html>
